"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("prop-types"),n=require("invariant"),r=require("json2mq");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=a(e),i=a(t),o=a(n),f=a(r);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var l=function(){function e(e,t,n){var r=this;this.nativeMediaQueryList=e.matchMedia(t),this.active=!0,this.cancellableListener=function(){r.matches=r.nativeMediaQueryList.matches,r.active&&n.apply(void 0,arguments)},this.nativeMediaQueryList.addListener(this.cancellableListener),this.matches=this.nativeMediaQueryList.matches}return e.prototype.cancel=function(){this.active=!1,this.nativeMediaQueryList.removeListener(this.cancellableListener)},e}(),s=function(t){var n=t.query,r=t.queries,a=t.defaultMatches,u=t.targetWindow,i=t.onChange;!function(e){var t=e.query,n=e.queries,r=e.defaultMatches;t||n||t&&n||o.default(!1),void 0!==r&&t&&"boolean"!=typeof r&&o.default(!1),void 0!==r&&n&&"object"!=typeof r&&o.default(!1)}({query:n,queries:r,defaultMatches:a});var s=e.useRef([]),d=function(){var e,t,n=s.current.reduce((function(e,t){var n,r=t.name,a=t.mqListener;return c({},e,((n={})[r]=a.matches,n))}),{});return e=n,1===(t=Object.keys(e)).length&&"__DEFAULT__"===t[0]?e.__DEFAULT__:e},y=function(){v(d())},h=e.useState((function(){return"object"!=typeof window?void 0!==a?a:!!n||Object.keys(r).reduce((function(e,t){var n;return c({},e,((n={})[t]=!0,n))}),{}):(function(){var e=u||window;"function"!=typeof e.matchMedia&&o.default(!1);var t=r||function(e){return{__DEFAULT__:e}}(n);s.current=Object.keys(t).map((function(n){var r=t[n],a="string"!=typeof r?f.default(r):r;return{name:n,mqListener:new l(e,a,y)}}))}(),d())})),p=h[0],v=h[1];return e.useEffect((function(){return function(){return s.current.forEach((function(e){return e.mqListener.cancel()}))}}),[]),e.useEffect((function(){i&&i(p)}),[p,i]),p},d=function(e){var t=e.defaultMatches,n=e.query,r=e.queries,a=e.render,i=e.children,o=e.targetWindow,f=e.onChange,c=s({query:n,queries:r,defaultMatches:t,targetWindow:o,onChange:f}),l="object"==typeof c?Object.keys(c).some((function(e){return c[e]})):c;return a?l?a(c):null:i?"function"==typeof i?i(c):(!Array.isArray(i)||i.length)&&l?u.default.Children.only(i)&&"string"==typeof u.default.Children.only(i).type?u.default.Children.only(i):u.default.cloneElement(u.default.Children.only(i),{matches:c}):null:null},y=i.default.oneOfType([i.default.string,i.default.object,i.default.arrayOf(i.default.object.isRequired)]);d.propTypes={defaultMatches:i.default.oneOfType([i.default.bool,i.default.objectOf(i.default.bool)]),query:y,queries:i.default.objectOf(y),render:i.default.func,children:i.default.oneOfType([i.default.node,i.default.func]),targetWindow:i.default.object,onChange:i.default.func},exports.default=d,exports.useMedia=s;
